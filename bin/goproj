#!/bin/bash

VERSION="0.1.0"

usage() {
  cat <<EOF
Usage: goproj COMMAND [*options]

Simplify Go(lang) development by providing a set of tools built around the 
original go tool.

Commands:

  new     Creates a new project structure.
  run     Run the a given command with GOPATH set to the project directory.
  go      Wraps the go tool, setting GOPATH prior to executing it.
  help    Show more information about a command, the argument being another
          command.

For more information, use go help:

  go help COMMAND

EOF
}

libexec() {
  local dir=$(cd -P "$(dirname "${BASH_SOURCE[0]}")/../libexec" && pwd)
  echo "${dir}"
}

run() {
  local cmd="${1}"

  if [[ ! $cmd ]]; then
    usage
    exit 0
  else
    local bin="$(libexec)/$(basename $0)-${cmd}"

    if which $bin > /dev/null; then
      shift
      $bin $@
    else
      echo -e "ERR: Unknown command ${cmd}\n"
      usage
      exit 1
    fi
  fi
}

run $@